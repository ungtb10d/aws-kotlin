// Code generated by smithy-kotlin-codegen. DO NOT EDIT!

package aws.sdk.kotlin.services.polly.paginators

import aws.sdk.kotlin.services.polly.PollyClient
import aws.sdk.kotlin.services.polly.model.ListSpeechSynthesisTasksRequest
import aws.sdk.kotlin.services.polly.model.ListSpeechSynthesisTasksResponse
import kotlinx.coroutines.flow.Flow
import kotlinx.coroutines.flow.flow


/**
 * Paginate over [ListSpeechSynthesisTasksResponse] results.
 * When this operation is called, a [kotlinx.coroutines.Flow] is created. Flows are lazy (cold) so no service calls are
 * made until the flow is collected. This also means there is no guarantee that the request is valid until then. Once
 * you start collecting the flow, the SDK will lazily load response pages by making service calls until there are no
 * pages left or the flow is cancelled. If there are errors in your request, you will see the failures only after you start
 * collection.
 * @param initialRequest A [ListSpeechSynthesisTasksRequest] to start pagination
 * @return A [kotlinx.coroutines.flow.Flow] that can collect [ListSpeechSynthesisTasksResponse]
 */
fun PollyClient.listSpeechSynthesisTasksPaginated(initialRequest: ListSpeechSynthesisTasksRequest): Flow<ListSpeechSynthesisTasksResponse> =
    flow {
        var cursor: kotlin.String? = null
        var isFirstPage: Boolean = true

        while (isFirstPage || (cursor?.isNotEmpty() == true)) {
            val req = initialRequest.copy {
                this.nextToken = cursor
            }
            val result = this@listSpeechSynthesisTasksPaginated.listSpeechSynthesisTasks(req)
            isFirstPage = false
            cursor = result.nextToken
            emit(result)
        }
    }
